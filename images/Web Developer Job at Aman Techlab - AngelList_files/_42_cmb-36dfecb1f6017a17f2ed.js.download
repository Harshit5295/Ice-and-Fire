webpackJsonp([146],{1159:function(e,n,t){void(e.exports=Promise.all([{},t.e(19).then(t.bind(null,709)),t.e(20).then(t.bind(null,710)),t.e(34).then(t.bind(null,750)),t.e(29).then(t.bind(null,739)),t.e(22).then(t.bind(null,713)),t.e(423).then(t.bind(null,2271)),t.e(422).then(t.bind(null,2272)),t.e(259).then(t.bind(null,1462)),t.e(617).then(t.bind(null,1941))]).then(function(){return function(e,n,t,r,i,a,o,u,s,l){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}function d(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}function f(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function v(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}function h(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function y(e){var n=e.reduce(function(e,n){return e[n.type]?e[n.type]=e[n.type].concat(n):e[n.type]=[n],e},{});return n[N]={questionIds:P(n[N]),options:(0,j["default"])(n[N])},n[x]={questionIds:P(n[x]),options:(0,j["default"])(n[x])},n}function P(e){return e.reduce(function(e,n){return n.question.includes("MOST")&&(e.very_interested=n.id),n.question.includes("NOT")&&(e.not_interested=n.id),e},{})}function b(e,n){var t=e.questionId,r=e.optionId,i=void 0,a=n.currentUser.jobPreferences.find(function(e){return e.id===t}).preferences;return r&&(i=a.findIndex(function(e){return e.optionId===r})),{preferences:a,index:i}}function S(e){var n=e.question,t=e.optionName,r=e.value;return _["default"].track("Candidate job preference updated",{preference_question:n,preference_tag_name:t,preference_value:r}),!0}Object.defineProperty(e,"__esModule",{value:!0});var I,m=c(n),q=c(t),_=c(a),g=c(o),k=c(u),M=c(s),j=c(l),C=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},O=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),w="company_size",N="market",x="tech_stack",T="culture",Q=(I={},h(I,N,5),h(I,x,5),h(I,T,2),I),z=function(e){function n(e){var t;f(this,n);var r=p(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return r.state={isLoading:!0,indexedQuestions:(t={},h(t,w,[]),h(t,N,{questionIds:{},options:{very_interested:[],not_interested:[],unselected:[]}}),h(t,x,{questionIds:{},options:{very_interested:[],not_interested:[],unselected:[]}}),h(t,T,[]),t)},r.handleSaveCompanySizePreference=r.handleSaveCompanySizePreference.bind(r),r.handleSaveCultureSinglePreference=r.handleSaveCultureSinglePreference.bind(r),r.handleSaveCultureMultiPreference=r.handleSaveCultureMultiPreference.bind(r),r.handleSaveMarketPreference=r.handleSaveMarketPreference.bind(r),r.handleSaveTechStackPreference=r.handleSaveTechStackPreference.bind(r),r}return v(n,e),O(n,[{key:"componentWillReceiveProps",value:function(e){var n=e.data,t=n.loading,r=n.error,i=n.currentUser,a=e.onLoad,o=!t&&!r&&i.jobPreferences;if(o){var u=y(i.jobPreferences);this.setState({indexedQuestions:u,isLoading:!1}),a()}}},{key:"handleSaveCompanySizePreference",value:function(e){var n=e.questionId,t=e.val,r=e.preference,i=[C({},r,{value:t})];this.savePreferences({questionId:n,preferences:i})}},{key:"handleSaveCultureSinglePreference",value:function(e,n){var t=e.questionId,r=e.optionName,i=e.optionId,a=this.props.data;null===n&&(n="very_interested");var o=b({questionId:t},a).preferences.filter(function(e){return e.optionId!==i&&null!==e.value}).map(function(e){return C({},e,{value:null})}),u={optionName:r,optionId:i,value:n};this.savePreferences({questionId:t,preferences:[].concat(d(o),[u])})}},{key:"handleSaveCultureMultiPreference",value:function(e,n){var t=e.questionId,r=e.optionName,i=e.optionId,a=this.props.data,o=b({questionId:t},a).preferences.filter(function(e){return"very_interested"===e.value}),u="very_interested"===n?"not_interested":"very_interested";if(!("very_interested"===u&&o.length>=Q[T])){var s=[{optionName:r,optionId:i,value:u}];this.savePreferences({questionId:t,preferences:s})}}},{key:"handleSaveMarketPreference",value:function(e){var n=e.val,t=e.selected;this.handleSaveMultiPreference({type:N,val:n,selected:t})}},{key:"handleSaveTechStackPreference",value:function(e){var n=e.val,t=e.selected;this.handleSaveMultiPreference({type:x,val:n,selected:t})}},{key:"handleSaveMultiPreference",value:function(e){var n=e.type,t=e.val,r=e.selected,a=this.state.indexedQuestions[n],o=a.options[t]||[];if(r&&r.length>Q[n])return null;var u=r.length?(0,i.xorWith)(o,r,i.isEqual):o,s=r.length>o.length?t:null,l=u.map(function(e){var n=e.label,t=e.value;return{optionName:n,optionId:t,value:s}}),c=a.questionIds[t];this.savePreferences({questionId:c,preferences:l})}},{key:"savePreferences",value:function(e){var n=e.questionId,t=e.preferences,r=this.props,i=r.onPreferencesSaved,a=r.onPreferencesModified,o=r.savePreference,u=r.userId,s=r.data.currentUser.jobPreferences;a(),Promise.all(t.map(function(e){return o({userId:u,questionId:n,preference:e}).then(function(){return S({question:s.find(function(e){return e.id===n}).question,optionName:e.optionName,value:e.value})})})).then(i)}},{key:"render",value:function(){var e=this.state,n=e.isLoading,t=e.indexedQuestions;return m["default"].createElement(M["default"],{isLoading:n,companySizeQuestions:t[w],marketOptions:t[N].options,techStackOptions:t[x].options,cultureQuestions:t[T],onSaveCompanySizePreference:this.handleSaveCompanySizePreference,onSaveMarketPreference:this.handleSaveMarketPreference,onSaveTechStackPreference:this.handleSaveTechStackPreference,onSaveCultureSinglePreference:this.handleSaveCultureSinglePreference,onSaveCultureMultiPreference:this.handleSaveCultureMultiPreference})}}]),n}(n.PureComponent);z.propTypes={onPreferencesSaved:q["default"].func,userId:q["default"].number.isRequired,onLoad:q["default"].func,onPreferencesModified:q["default"].func,data:q["default"].object.isRequired,savePreference:q["default"].func.isRequired},z.defaultProps={onPreferencesSaved:function(){},onLoad:function(){},onPreferencesModified:function(){}};var L=(0,r.compose)((0,r.graphql)(k["default"],{props:function(e){var n=e.mutate;return{savePreference:function(e){var t=e.userId,r=e.questionId,i=e.preference,a=i.optionName,o=i.optionId,u=i.value;return n({variables:{input:{userId:t,questionId:r,optionId:o,value:u}},optimisticResponse:{__typename:"Mutation",jobPreference:{__typename:"JobPreference",optionName:a,optionId:o,value:u}},update:function(e,n){var i=n.data.jobPreference,a=e.readQuery({query:g["default"],variables:{userId:t}}),u=b({questionId:r,optionId:o},a),s=u.preferences,l=u.index;s[l]=i,e.writeQuery({query:g["default"],variables:{userId:t},data:a})}})}}}}),(0,r.graphql)(g["default"],{options:function(e){var n=e.userId;return{variables:{userId:n}}}}));e["default"]=L(z)}.apply(void 0,arguments[0]),arguments[0][0]}.bind(this)))}});