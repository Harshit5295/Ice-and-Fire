webpackJsonp([284],{1437:function(t,e,i){void(t.exports=Promise.all([{},i.e(19).then(i.bind(null,709)),i.e(20).then(i.bind(null,710)),i.e(22).then(i.bind(null,713)),i.e(309).then(i.bind(null,1412)),i.e(285).then(i.bind(null,1436))]).then(function(){return function(t,e,i,o,n,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0});var u=s(e),p=s(i),h=s(o),f=s(a),b=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),g=function(t){function e(t){l(this,e);var i=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.state={isOpen:!0,isLoadingModal:!0,isProcessingApplication:!1,isApplicationSuccessful:!1,shouldAskWorkAuthorization:!1,unmatchedLocations:[],startup:null,candidate:null,jobListings:[],isNoteRequired:!1,error:"",selectedJobListings:[],note:"",isAuthorizedToWork:null,relocationLocationTagIds:[]},i.handleAddJobListing=i.handleAddJobListing.bind(i),i.handleRemoveJobListing=i.handleRemoveJobListing.bind(i),i.handleEnterNote=i.handleEnterNote.bind(i),i.handleSetWorkAuthorization=i.handleSetWorkAuthorization.bind(i),i.handleSetRelocationPreference=i.handleSetRelocationPreference.bind(i),i.handleSubmitApplication=i.handleSubmitApplication.bind(i),i.handleUndoApplication=i.handleUndoApplication.bind(i),i.handleDismissError=i.handleDismissError.bind(i),i.handleCloseModal=i.handleCloseModal.bind(i),i}return d(e,t),b(e,[{key:"componentDidMount",value:function(){this.loadJobApplicationDetails()}},{key:"componentDidUpdate",value:function(t,e){e.selectedJobListings.length!==this.state.selectedJobListings.length&&this.checkQualificationQuestions()}},{key:"loadJobApplicationDetails",value:function(){var t=this,e=this.props,i=e.matchedJobListings,o=e.startupId;if(o)return(0,n.getJobApplicationDetails)({startupId:o,matchedJobListings:i}).then(function(e){var i=e.startup,n=e.candidate,a=e.job_listings,s=e.is_note_required;h["default"].track("Application Modal opened",{startup_id:o}),t.setState({startup:i,candidate:n,jobListings:a,isNoteRequired:s,isLoadingModal:!1}),a.length>0&&t.setState({selectedJobListings:[a[0].id]})})["catch"](function(){t.setState({error:"Unable to load details for the job application. Please try again.",isLoadingModal:!1})})}},{key:"modifySelectedJobListings",value:function(t,e){var i=this.state,o=i.selectedJobListings,n=i.startup,a=[],s="";"add"===t?(a=[].concat(r(o),[e]),s="Application Modal: Add position to application"):(a=o.filter(function(t){return t!==e}),s="Application Modal: Remove position from application"),h["default"].track(s,{startup_id:n.id,job_listing_id:e}),this.setState({selectedJobListings:a,error:""})}},{key:"checkQualificationQuestions",value:function(){var t=this.state,e=t.selectedJobListings,i=t.jobListings,o=[],n=!1;e.forEach(function(t){var e=i.find(function(e){return e.id===t}),a=e.qualifications,s=a.request_us_authorized,r=a.unmatched_locations;n=n||s,r.forEach(function(t){o.find(function(e){return e.id===t.id})||o.push(t)})}),this.setState({shouldAskWorkAuthorization:n,unmatchedLocations:o})}},{key:"updateQualifications",value:function(){var t=this,e=this.state,i=e.startup.id,o=e.isAuthorizedToWork,a=e.relocationLocationTagIds;return null!==o&&h["default"].track("Application Modal: Answered work authorization question",{startup_id:i,answer:o}),a.length>0&&h["default"].track("Application Modal: Selected relocation locations",{startup_id:i,locations:a}),(0,n.updateJobProfileQualifications)({isAuthorizedToWork:o,relocationLocationTagIds:a})["catch"](function(){t.setState({error:"Unable to update your job qualifications. Please try again."})})}},{key:"handleAddJobListing",value:function(t){this.modifySelectedJobListings("add",parseInt(t.target.value,10))}},{key:"handleRemoveJobListing",value:function(t){this.modifySelectedJobListings("remove",t)}},{key:"handleSetWorkAuthorization",value:function(t){this.setState({isAuthorizedToWork:"workauth-yes"===t.target.value,error:""})}},{key:"handleSetRelocationPreference",value:function(t){var e=this.state.relocationLocationTagIds,i=parseInt(t.target.id,10),o=[];o=e.includes(i)?e.filter(function(t){return t!==i}):[].concat(r(e),[i]),this.setState({relocationLocationTagIds:o,error:""})}},{key:"handleEnterNote",value:function(t){this.setState({note:t.target.value,error:""})}},{key:"handleSubmitApplication",value:function(){var t=this,e=this.state,i=e.startup.id,o=e.selectedJobListings,a=e.note,s=e.isAuthorizedToWork,r=e.relocationLocationTagIds,l=this.props.promotionEventId;return h["default"].track("Application Modal: Send job application",{startup_id:i,note_included:!!a,job_listings_selected:o.length}),this.setState({isProcessingApplication:!0,error:""}),(null!==s||r.length>0)&&this.updateQualifications(),(0,n.submitJobApplication)({startupId:i,jobListingIds:o,promotionEventId:l,note:a}).then(function(e){t.setState({isApplicationSuccessful:!0,isProcessingApplication:!1,error:""}),t.props.onApplicationSuccess(e)})["catch"](function(){t.setState({error:"Unable to submit the job application. Please try again.",isProcessingApplication:!1})})}},{key:"handleUndoApplication",value:function(){var t=this,e=this.state.startup.id;return h["default"].track("Application Modal: Undo job application",{startup_id:e}),this.setState({isProcessingApplication:!0,error:""}),(0,n.undoJobApplication)({startupId:e}).then(function(e){t.setState({isApplicationSuccessful:!1,isProcessingApplication:!1}),t.props.onApplicationUndo(e)})["catch"](function(){t.setState({error:"Unable to undo the job application. Please try again.",isProcessingApplication:!1})})}},{key:"handleDismissError",value:function(){this.setState({error:""})}},{key:"handleCloseModal",value:function(){this.setState({isOpen:!1,error:""})}},{key:"render",value:function(){var t=this.state,e=t.isNoteRequired,i=t.isApplicationSuccessful,o=t.isProcessingApplication,n=t.isLoadingModal,a=t.isOpen,s=t.startup,r=t.candidate,l=t.jobListings,c=t.error,d=t.selectedJobListings,p=t.note,h=t.shouldAskWorkAuthorization,b=t.unmatchedLocations,g=t.isAuthorizedToWork,A=t.relocationLocationTagIds;return u["default"].createElement(f["default"],{isLoadingModal:n,isOpen:a,parentSelector:function(){return document.body},onCloseModal:this.handleCloseModal,startup:s,candidate:r,jobListings:l,error:c,selectedJobListings:d,note:p,isAuthorizedToWork:g,relocationLocationTagIds:A,shouldAskWorkAuthorization:h,unmatchedLocations:b,isNoteRequired:e,isProcessingApplication:o,isApplicationSuccessful:i,onAddJobListing:this.handleAddJobListing,onRemoveJobListing:this.handleRemoveJobListing,onSetWorkAuthorization:this.handleSetWorkAuthorization,onSetRelocationPreference:this.handleSetRelocationPreference,onEnterNote:this.handleEnterNote,onSubmitApplication:this.handleSubmitApplication,onUndoApplication:this.handleUndoApplication,onDismissError:this.handleDismissError})}}]),e}(e.Component);t["default"]=g,g.propTypes={matchedJobListings:p["default"].array,promotionEventId:p["default"].number,onApplicationSuccess:p["default"].func.isRequired,onApplicationUndo:p["default"].func,startupId:p["default"].number.isRequired},g.defaultProps={matchedJobListings:[],promotionEventId:null,onApplicationUndo:function(){}}}.apply(void 0,arguments[0]),arguments[0][0]}.bind(this)))}});